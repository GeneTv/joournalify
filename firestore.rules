rules_version = '2';
service cloud.firestore {


  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write, delete, create: if false;
    }
    
    // [AUTH] Allow read and create
		match /journals/{journal} {
    	allow read, create: if true;
    }
    
    // [AUTH] Allow delete own journal
    match /journals/{journal} {
    	allow delete: if isAuthorized();
    }
    
    // [AUTH] Allow write own journal
    match /journals/{journal} {
    	allow write: if isAuthorized();
    }
    
  }
  
  
  function isLoggedIn() {
  	return request.auth != null;
	}
  function isAuthorized() {
  	return isLoggedIn() && resource != null && resource.data.author == request.auth.uid;
	}
}